📝 日志文件: logs/experiment_20251204_094219.log
⏰ 开始时间: 2025-12-04 09:42:19
============================================================
🚀 实验运行器初始化完成
🧪 开始HALT-CoT增强实验
============================================================
✅ 已加载 10 条测试数据
🤖 加载模型: Qwen/Qwen2.5-7B-Instruct
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|##5       | 1/4 [00:00<00:02,  1.24it/s]Loading checkpoint shards:  50%|#####     | 2/4 [00:01<00:01,  1.29it/s]Loading checkpoint shards:  75%|#######5  | 3/4 [00:02<00:00,  1.30it/s]Loading checkpoint shards: 100%|##########| 4/4 [00:03<00:00,  1.35it/s]Loading checkpoint shards: 100%|##########| 4/4 [00:03<00:00,  1.32it/s]
✅ 模型已加载到: cuda:0
[SmartHaltDecisionMaker] 初始化配置:
  - use_consistency: True
  - use_entropy: True
  - consistency_k: 3
  - entropy_threshold: 0.6
  - entropy_consecutive_steps: 2
  - min_tokens_before_check: 100
  - cooldown_tokens: 40
🔧 实验管理器初始化: 智能检测=False, 句子边界检测=True

📝 样本 1: How many vertical asymptotes does the graph of $y=\frac{2}{x^2+x-6}$ have?...
   ❌ 处理失败: CheckpointResult.__init__() missing 1 required positional argument: 'halt_reason'
Traceback (most recent call last):
  File "/root/autodl-tmp/halt_cot_project/src/experiment_manager.py", line 92, in run_single_sample
    result_data = self._generation_loop(
                  ^^^^^^^^^^^^^^^^^^^^^^
  File "/root/autodl-tmp/halt_cot_project/src/experiment_manager.py", line 199, in _generation_loop
    probe_result = probe_system.probe_answer(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/autodl-tmp/halt_cot_project/src/probe_system.py", line 164, in probe_answer
    return CheckpointResult(
           ^^^^^^^^^^^^^^^^^
TypeError: CheckpointResult.__init__() missing 1 required positional argument: 'halt_reason'

📝 样本 2: Kite $ABCD$ (a quadrilateral with two pairs of adjacent equal sides) has coordin...
   ❌ 处理失败: CheckpointResult.__init__() missing 1 required positional argument: 'halt_reason'
Traceback (most recent call last):
  File "/root/autodl-tmp/halt_cot_project/src/experiment_manager.py", line 92, in run_single_sample
    result_data = self._generation_loop(
                  ^^^^^^^^^^^^^^^^^^^^^^
  File "/root/autodl-tmp/halt_cot_project/src/experiment_manager.py", line 199, in _generation_loop
    probe_result = probe_system.probe_answer(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/autodl-tmp/halt_cot_project/src/probe_system.py", line 164, in probe_answer
    return CheckpointResult(
           ^^^^^^^^^^^^^^^^^
TypeError: CheckpointResult.__init__() missing 1 required positional argument: 'halt_reason'

📝 样本 3: If $A$, $B$ and $C$ are positive integers such that $\frac{A\sqrt{B}}{C} = \frac...
   ❌ 处理失败: CheckpointResult.__init__() missing 3 required positional arguments: 'should_halt', 'halt_reason', and 'answer'
Traceback (most recent call last):
  File "/root/autodl-tmp/halt_cot_project/src/experiment_manager.py", line 92, in run_single_sample
    result_data = self._generation_loop(
                  ^^^^^^^^^^^^^^^^^^^^^^
  File "/root/autodl-tmp/halt_cot_project/src/experiment_manager.py", line 199, in _generation_loop
    probe_result = probe_system.probe_answer(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/autodl-tmp/halt_cot_project/src/probe_system.py", line 235, in probe_answer
    return CheckpointResult(entropy=100.0)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: CheckpointResult.__init__() missing 3 required positional arguments: 'should_halt', 'halt_reason', and 'answer'

📝 样本 4: Ten treeks weigh as much as three squigs and one goolee. Two treeks and one gool...
   ❌ 处理失败: CheckpointResult.__init__() missing 3 required positional arguments: 'should_halt', 'halt_reason', and 'answer'
Traceback (most recent call last):
  File "/root/autodl-tmp/halt_cot_project/src/experiment_manager.py", line 92, in run_single_sample
    result_data = self._generation_loop(
                  ^^^^^^^^^^^^^^^^^^^^^^
  File "/root/autodl-tmp/halt_cot_project/src/experiment_manager.py", line 199, in _generation_loop
    probe_result = probe_system.probe_answer(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/autodl-tmp/halt_cot_project/src/probe_system.py", line 235, in probe_answer
    return CheckpointResult(entropy=100.0)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: CheckpointResult.__init__() missing 3 required positional arguments: 'should_halt', 'halt_reason', and 'answer'

📝 样本 5: At constant temperature, the pressure of a sample of gas is inversely proportion...
   ❌ 处理失败: CheckpointResult.__init__() missing 1 required positional argument: 'halt_reason'
Traceback (most recent call last):
  File "/root/autodl-tmp/halt_cot_project/src/experiment_manager.py", line 92, in run_single_sample
    result_data = self._generation_loop(
                  ^^^^^^^^^^^^^^^^^^^^^^
  File "/root/autodl-tmp/halt_cot_project/src/experiment_manager.py", line 199, in _generation_loop
    probe_result = probe_system.probe_answer(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/autodl-tmp/halt_cot_project/src/probe_system.py", line 164, in probe_answer
    return CheckpointResult(
           ^^^^^^^^^^^^^^^^^
TypeError: CheckpointResult.__init__() missing 1 required positional argument: 'halt_reason'
📊 进度: 5/10, 准确率: 0.00%, 早停率: 0.00%, 平均tokens: 0.0

📝 样本 6: Eight pounds of feathers and two ounces of gold together cost $\$932$. Fourteen ...
   ❌ 处理失败: CheckpointResult.__init__() missing 3 required positional arguments: 'should_halt', 'halt_reason', and 'answer'
Traceback (most recent call last):
  File "/root/autodl-tmp/halt_cot_project/src/experiment_manager.py", line 92, in run_single_sample
    result_data = self._generation_loop(
                  ^^^^^^^^^^^^^^^^^^^^^^
  File "/root/autodl-tmp/halt_cot_project/src/experiment_manager.py", line 199, in _generation_loop
    probe_result = probe_system.probe_answer(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/autodl-tmp/halt_cot_project/src/probe_system.py", line 235, in probe_answer
    return CheckpointResult(entropy=100.0)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: CheckpointResult.__init__() missing 3 required positional arguments: 'should_halt', 'halt_reason', and 'answer'

📝 样本 7: Find the radius of the circle with equation $x^2 + 8x + y^2 - 6y = 0$....
   ❌ 处理失败: CheckpointResult.__init__() missing 3 required positional arguments: 'should_halt', 'halt_reason', and 'answer'
Traceback (most recent call last):
  File "/root/autodl-tmp/halt_cot_project/src/experiment_manager.py", line 92, in run_single_sample
    result_data = self._generation_loop(
                  ^^^^^^^^^^^^^^^^^^^^^^
  File "/root/autodl-tmp/halt_cot_project/src/experiment_manager.py", line 199, in _generation_loop
    probe_result = probe_system.probe_answer(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/autodl-tmp/halt_cot_project/src/probe_system.py", line 235, in probe_answer
    return CheckpointResult(entropy=100.0)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: CheckpointResult.__init__() missing 3 required positional arguments: 'should_halt', 'halt_reason', and 'answer'

📝 样本 8: If $9^{18n}=27^{24}$, find $n$....
   ❌ 处理失败: CheckpointResult.__init__() missing 1 required positional argument: 'halt_reason'
Traceback (most recent call last):
  File "/root/autodl-tmp/halt_cot_project/src/experiment_manager.py", line 92, in run_single_sample
    result_data = self._generation_loop(
                  ^^^^^^^^^^^^^^^^^^^^^^
  File "/root/autodl-tmp/halt_cot_project/src/experiment_manager.py", line 199, in _generation_loop
    probe_result = probe_system.probe_answer(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/autodl-tmp/halt_cot_project/src/probe_system.py", line 164, in probe_answer
    return CheckpointResult(
           ^^^^^^^^^^^^^^^^^
TypeError: CheckpointResult.__init__() missing 1 required positional argument: 'halt_reason'

📝 样本 9: Evaluate $(1+2i)6-3i$....
   ❌ 处理失败: CheckpointResult.__init__() missing 3 required positional arguments: 'should_halt', 'halt_reason', and 'answer'
Traceback (most recent call last):
  File "/root/autodl-tmp/halt_cot_project/src/experiment_manager.py", line 92, in run_single_sample
    result_data = self._generation_loop(
                  ^^^^^^^^^^^^^^^^^^^^^^
  File "/root/autodl-tmp/halt_cot_project/src/experiment_manager.py", line 199, in _generation_loop
    probe_result = probe_system.probe_answer(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/autodl-tmp/halt_cot_project/src/probe_system.py", line 235, in probe_answer
    return CheckpointResult(entropy=100.0)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: CheckpointResult.__init__() missing 3 required positional arguments: 'should_halt', 'halt_reason', and 'answer'

📝 样本 10: Simplify $(2-2i)(5+5i)$, where $i^2 = -1.$...
   ❌ 处理失败: CheckpointResult.__init__() missing 3 required positional arguments: 'should_halt', 'halt_reason', and 'answer'
Traceback (most recent call last):
  File "/root/autodl-tmp/halt_cot_project/src/experiment_manager.py", line 92, in run_single_sample
    result_data = self._generation_loop(
                  ^^^^^^^^^^^^^^^^^^^^^^
  File "/root/autodl-tmp/halt_cot_project/src/experiment_manager.py", line 199, in _generation_loop
    probe_result = probe_system.probe_answer(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/autodl-tmp/halt_cot_project/src/probe_system.py", line 235, in probe_answer
    return CheckpointResult(entropy=100.0)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: CheckpointResult.__init__() missing 3 required positional arguments: 'should_halt', 'halt_reason', and 'answer'
📊 进度: 10/10, 准确率: 0.00%, 早停率: 0.00%, 平均tokens: 0.0

============================================================
📊 HALT-CoT 实验统计结果
============================================================
🤖 模型: Qwen/Qwen2.5-7B-Instruct
📝 总样本数: 10
✅ 正确样本: 0
🎯 准确率: 0.00%
🛑 早停率: 0.00% (0/10)
⏱️  平均用时: 0.0秒/样本
💬 平均Token: 0.0个/样本
📊 Token范围: 0 - 0
📉 平均熵: 0.000
🔍 平均检查点: 0.0次/样本
🕐 总用时: 0分0秒
🔍 检测模式: 句子边界检测
============================================================
💾 结果已保存: /root/autodl-tmp/results/halt_cot_qwen2.5-7b_sentence_10samples_20251204_094249.json
📄 摘要已保存: /root/autodl-tmp/results/halt_cot_qwen2.5-7b_sentence_10samples_20251204_094249_summary.txt

🎉 实验完成!
📁 结果文件: /root/autodl-tmp/results/halt_cot_qwen2.5-7b_sentence_10samples_20251204_094249.json

📈 实验成功完成，处理了 10 个样本
💡 融合了两种早停方法：
   1. 答案一致性检测（Liu & Wang 2025）
   2. 熵基早停（Laaouach HALT-CoT）
============================================================
⏰ 结束时间: 2025-12-04 09:42:49
